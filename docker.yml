- name: Deploy to EC2
  uses: appleboy/ssh-action@v1.0.0
  with:
    host: ${{ secrets.EC2_HOST}}   
    username: ec2-user
    key: ${{ secrets.EC2_SSH_KEY }}
    script: |
      set -eux
      cd ~/project-1-maven-jenkins-CICD-docker-eks- || git clone https://github.com/swathichaganti91/project-1-maven-jenkins-CICD-docker-eks-.git && cd project-1-maven-jenkins-CICD-docker-eks-

      docker stop docker1 || true
      docker rm docker1 || true

      docker build -t docker1 .
      docker run -p 8075:8080 -d --name docker1 docker1

      docker ps -a
      docker logs docker1 || true
